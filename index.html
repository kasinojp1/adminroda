<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Roda Hadiah â€” Natal KASINOJP</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body {
  font-family: 'Poppins', sans-serif;
  background: linear-gradient(180deg,#071229,#0c1624);
  color:#fff;
  padding:20px;
  max-width:600px;
  margin:0 auto;
}
h1 {
  font-size:28px;
  text-align:center;
  margin-bottom:20px;
  background: linear-gradient(90deg,#ffef9f,#d4af37);
  -webkit-background-clip:text;
  color:transparent;
}
section {margin-bottom:30px;}
input, button {
  padding:10px 14px;
  border-radius:8px;
  border:none;
  font-weight:600;
}
button {
  background:#ffef9f;
  color:#111;
  cursor:pointer;
  margin-left:6px;
}
button:hover {background:#ffd966;}
ul {margin-top:10px;}
li {margin-bottom:6px;}
</style>
</head>
<body>

<h1>Admin Roda Hadiah</h1>

<section>
  <h2>Set Hadiah</h2>
  <input type="text" id="newPrize" placeholder="Masukkan hadiah baru">
  <button id="addPrizeBtn">Tambah</button>
  <button id="savePrizeBtn">Simpan ke Firebase</button>
  <ul id="prizeList"></ul>
</section>

<section>
  <h2>Buat Voucher</h2>
  <input type="text" id="voucherCode" placeholder="Masukkan kode voucher">
  <button id="createVoucherBtn">Buat Voucher</button>
  <ul id="voucherList"></ul>
</section>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getDatabase, ref, set, get, onValue, push } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyDlpuf_uIlpmr2ybAqpJ2GTTRW-t86PGf0",
  authDomain: "hadiahnatal-a033b.firebaseapp.com",
  databaseURL: "https://hadiahnatal-a033b-default-rtdb.firebaseio.com",
  projectId: "hadiahnatal-a033b",
  storageBucket: "hadiahnatal-a033b.firebasestorage.app",
  messagingSenderId: "577153304596",
  appId: "1:577153304596:web:5f255e886a379ccb12bf01",
  measurementId: "G-C5Q83YQ6SK"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const prizeListEl = document.getElementById('prizeList');
const voucherListEl = document.getElementById('voucherList');

let prizes = [];

// --- Set Hadiah ---
const newPrizeInput = document.getElementById('newPrize');
document.getElementById('addPrizeBtn').addEventListener('click', ()=>{
  const val = newPrizeInput.value.trim();
  if(!val) return alert('Isi nama hadiah!');
  prizes.push(val);
  renderPrizes();
  newPrizeInput.value='';
});

function renderPrizes(){
  prizeListEl.innerHTML='';
  prizes.forEach((p,i)=>{
    const li=document.createElement('li');
    li.textContent=p;
    prizeListEl.appendChild(li);
  });
}

document.getElementById('savePrizeBtn').addEventListener('click', async ()=>{
  if(prizes.length===0) return alert('Tidak ada hadiah untuk disimpan!');
  await set(ref(db,'gameConfig/prizes'),prizes);
  alert('Hadiah berhasil disimpan ke Firebase!');
});

// --- Buat Voucher ---
const voucherInput = document.getElementById('voucherCode');
document.getElementById('createVoucherBtn').addEventListener('click', async ()=>{
  const code = voucherInput.value.trim();
  if(!code) return alert('Masukkan kode voucher!');
  const voucherRef = ref(db,'gameConfig/vouchers/'+code);
  const snap = await get(voucherRef);
  if(snap.exists()){
    alert('Voucher sudah ada!');
    return;
  }
  await set(voucherRef,{created:Date.now()});
  voucherInput.value='';
  alert('Voucher berhasil dibuat!');
});

// --- Tampilkan voucher & hadiah realtime ---
const vouchersRef = ref(db,'gameConfig/vouchers');
onValue(vouchersRef,snap=>{
  voucherListEl.innerHTML='';
  snap.forEach(child=>{
    const li = document.createElement('li');
    li.textContent = child.key;
    voucherListEl.appendChild(li);
  });
});

const prizesRef = ref(db,'gameConfig/prizes');
onValue(prizesRef,snap=>{
  if(snap.exists()){
    prizes = snap.val();
    renderPrizes();
  }
});
</script>
</body>
</html>
